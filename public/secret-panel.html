<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="style.css">
  <title>Secret Panel</title>
</head>

<body>

<h2>ðŸ¤« Secret Panel</h2>

<div id="games"></div>

<script>

async function load(){

  const list = await fetch("/games").then(r=>r.json());

  games.innerHTML="";

  list.forEach(id=>{

    const d=document.createElement("div");
    d.className="card";

    d.innerHTML=`
      <h3>${id}</h3>

      Early5 <input id="${id}e"><br>
      Top <input id="${id}t"><br>
      Middle <input id="${id}m"><br>
      Bottom <input id="${id}b"><br>
      Full <input id="${id}f"><br><br>

      <button onclick="setSecret('${id}')">Save</button>

      <span id="${id}msg" style="margin-left:10px;color:green;font-weight:bold"></span>
    `;

    games.appendChild(d);
  });
}


/* ============================= */

async function setSecret(id){

  await fetch("/secret/"+id,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      early5:document.getElementById(id+"e").value,
      top:document.getElementById(id+"t").value,
      mid:document.getElementById(id+"m").value,
      bot:document.getElementById(id+"b").value,
      full:document.getElementById(id+"f").value
    })
  });

  const msg=document.getElementById(id+"msg");

  msg.innerText="Saved âœ…";

  setTimeout(()=>msg.innerText="",2000);
}

/* ============================= */

load();

</script>
</body>
</html>

